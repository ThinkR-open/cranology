
<!-- README.md is generated from README.Rmd. Please edit that file -->

# {cranology}: The CRAN Chronology

<!-- badges: start -->

[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![R-CMD-check](https://github.com/ThinkR-open/cranology/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/ThinkR-open/cranology/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of `{cranology}` is to provide tools to scrape data from CRAN
and MRAN websites as well as useful datasets to explore the evolution of
the number of packages on CRAN.

## Installation

You can install the development version of `{cranology}` with:

``` r
remotes::install_github("ThinkR-open/cranology")
```

## Examples

``` r
library(cranology)
```

### Datasets

All packages ever available on CRAN.

``` r
cran_packages_history
#> # A tibble: 37,823 × 10
#>    file_name    date                time  size  package_name last_archived      
#>    <chr>        <dttm>              <chr> <chr> <chr>        <dttm>             
#>  1 A3/          2015-08-16 21:05:00 21:05 -     A3           2015-08-16 21:05:00
#>  2 aaMI/        2010-07-30 12:17:00 12:17 -     aaMI         2010-07-30 12:17:00
#>  3 aaSEA/       2022-06-21 05:12:00 05:12 -     aaSEA        2022-06-21 05:12:00
#>  4 aba/         2022-03-27 06:29:00 06:29 -     aba          2022-03-27 06:29:00
#>  5 abbyyR/      2019-06-25 04:30:00 04:30 -     abbyyR       2019-06-25 04:30:00
#>  6 abc/         2022-05-19 07:20:00 07:20 -     abc          2022-05-19 07:20:00
#>  7 ABCanalysis/ 2017-03-13 13:31:00 13:31 -     ABCanalysis  2017-03-13 13:31:00
#>  8 abcdeFBA/    2022-03-07 06:20:00 06:20 -     abcdeFBA     2022-03-07 06:20:00
#>  9 ABCExtremes/ 2015-06-19 11:26:00 11:26 -     ABCExtremes  2015-06-19 11:26:00
#> 10 abclass/     2022-05-28 18:10:00 18:10 -     abclass      2022-05-28 18:10:00
#> # … with 37,813 more rows, and 4 more variables: archive <lgl>,
#> #   first_date <dttm>, n_versions <int>, last_modified <dttm>
```

The evolution of the number of packages on CRAN since its beginning.

``` r
cran_monthly_package_number
#> # A tibble: 297 × 2
#>    date       number_packages
#>    <date>               <dbl>
#>  1 1997-10-08               1
#>  2 1997-11-08               1
#>  3 1997-12-08               1
#>  4 1998-01-08               2
#>  5 1998-02-08               2
#>  6 1998-03-08               3
#>  7 1998-04-08               5
#>  8 1998-05-08               6
#>  9 1998-06-08               6
#> 10 1998-07-08               7
#> # … with 287 more rows
```

### Scraping tools

#### CRAN

Both `cran_packages_history` and `cran_monthly_package_number` datasets
are generated by the function `scrape_cran()`. The scraping process is
quite time consuming and relies on the `{furrr}` package to scrape the
CRAN pages asynchronously.

``` r
future::plan(future::multisession)
scrape_cran_history()
```

#### MRAN

`{cranology}` also includes the `get_package_number_mran()` function to
more quickly get the number that were available on CRAN at any given
date.

``` r
dates <- seq(
  from = as.Date("2018-04-10", "%Y-%m-%d"), 
  by = "1 year", 
  length.out = 4
)
get_package_number_mran(dates)
#> Scraping MRAN...
#> Scraping number packages on: 2018-04-10
#> Scraping number packages on: 2019-04-10
#> Scraping number packages on: 2020-04-10
#> Scraping number packages on: 2021-04-10
#>         date number_packages
#> 1 2018-04-10           12418
#> 2 2019-04-10           14042
#> 3 2020-04-10           15507
#> 4 2021-04-10           17398
```

Be careful though as this will only work for dates posterior to
`2014-09-17` the day when MRAN was up online for the first time.

``` r
get_package_number_mran("2013-08-28")
#> Error: Some dates are anterior to MRAN launch:
#> 1: 2013-08-28
```

For earlier dates use `cran_monthly_package_number`. Here is a naïve
example:

``` r
date_before_mran <- as.Date("2013-08-28")

cran_monthly_package_number[
  min(
    which(
      cran_monthly_package_number$date >= date_before_mran
    )
  ), 
]
#> # A tibble: 1 × 2
#>   date       number_packages
#>   <date>               <dbl>
#> 1 2013-09-08            4906
```

## Code of Conduct

Please note that this project is released with a [Contributor Code of
Conduct](https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html).
By contributing to this project, you agree to abide by its terms.
